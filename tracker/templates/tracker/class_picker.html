{% load static %}
<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>üå∏ Hello Kitty Fitness üå∏</title>
    <link rel="stylesheet" href="{% static 'tracker/css/class_picker.css' %}">
    <!--font Modak and DynaPuff-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&family=DynaPuff:wght@400..700&family=Maven+Pro:wght@400..900&family=Modak&family=Rubik+Bubbles&family=Sigmar+One&display=swap"
        rel="stylesheet">
</head>

<body>

    <div id="aboutPopup" class="popup-overlay">
        <div class="popup-box">
            <div class="popup-inner">
                <h2 class="popup-title">About us</h2>
                <p class="popup-desc">
                    Nh·ªØng t√¢m h·ªìn xinh x·∫Øn nhi·ªát huy·∫øt c√πng nhau t·∫°o n√™n Kitty Fitness ‚Äì
                    n∆°i c√¥ng ngh·ªá ch·∫°m ƒë·∫øn c·∫£m x√∫c v√† lan t·ªèa nƒÉng l∆∞·ª£ng y√™u th∆∞∆°ng üíñ
                </p>

                <ul class="popup-members">
                    <li>11245870 ‚Äì Nguy·ªÖn Kh√°nh Duy</li>
                    <li>11245886 ‚Äì Tr·∫ßn Th·ªã Nh·∫≠t Kh√°nh</li>
                    <li>11245840 ‚Äì V≈© ƒê·ª©c Anh</li>
                    <li>11245892 ‚Äì L√™ Ph·∫°m Kh√°nh Linh</li>
                    <li>11245921 ‚Äì Ho√†ng Th·ª•c Nhi</li>
                    <li>11245899 ‚Äì V≈© Tr·∫ßn C√°t Linh</li>
                </ul>

                <img class="kitty-left" src="{% static 'tracker/images/pop-up1.png' %}">
                <img class="kitty-right" src="{% static 'tracker/images/pop-up2.png' %}">
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="logo">
            <img src={% static 'tracker/images/gif3.gif' %} alt="Kitty Logo">
            <h1>Kitty Fitness</h1>
        </div>
        <nav>
            <a href="#" id="aboutBtn">About us</a>
        </nav>
    </header>


    <!--S·ª≠a ·ªü ƒë√¢y-->
    <div class="plan-main-content">
        <h1 class="main-title">ü§∏‚Äç‚ôÇÔ∏è Ch·ªçn lo·∫°i l·ªõp & t·∫°o k·∫ø ho·∫°ch t·∫≠p luy·ªán c·ªßa b·∫°n üèãÔ∏è‚Äç‚ôÄÔ∏è</h1>

        <form class="plan-generator-form" id="planForm">

            <div class="plan-section">
                <h2 class="section-title">üèÉ Priority Activity Group</h2>
                <div class="input-group">
                    <label>Ch·ªçn nh√≥m ho·∫°t ƒë·ªông b·∫°n mu·ªën t·∫≠p trung:</label>
                    <div class="activity-selector">

                        <input type="radio" id="outdoor" name="activity" value="Ngo√†i tr·ªùi" checked>
                        <label for="outdoor" class="icon-label">
                            <span class="activity-icon fas fa-mountain"></span>
                            <span>üèù Ngo√†i tr·ªùi</span>
                        </label>

                        <input type="radio" id="art" name="activity" value="Ngh·ªá thu·∫≠t">
                        <label for="art" class="icon-label">
                            <span class="activity-icon fas fa-masks-theater"></span>
                            <span>üíÉ Ngh·ªá thu·∫≠t</span>
                        </label>

                        <input type="radio" id="indoor" name="activity" value="Trong nh√†">
                        <label for="indoor" class="icon-label">
                            <span class="activity-icon fas fa-house-chimney"></span>
                            <span>üè° Trong nh√†</span>
                        </label>

                        <input type="radio" id="resistance" name="activity" value="Kh√°ng l·ª±c">
                        <label for="resistance" class="icon-label">
                            <span class="activity-icon fas fa-weight-hanging"></span>
                            <span>üèãÔ∏è Kh√°ng l·ª±c</span>
                        </label>

                    </div>
                </div>
            </div>

            <div class="plan-section">
                <h2 class="section-title">üóì Workout Frequency & Duration</h2>

                <div class="input-group">
                    <label>Ng√†y t·∫≠p trong tu·∫ßn:</label>
                    <div class="day-selector">
                        <input type="checkbox" id="t2" name="days" value="Th·ª© Hai" checked><label for="t2">T2</label>
                        <input type="checkbox" id="t3" name="days" value="Th·ª© Ba"><label for="t3">T3</label>
                        <input type="checkbox" id="t4" name="days" value="Th·ª© T∆∞" checked><label for="t4">T4</label>
                        <input type="checkbox" id="t5" name="days" value="Th·ª© NƒÉm"><label for="t5">T5</label>
                        <input type="checkbox" id="t6" name="days" value="Th·ª© S√°u" checked><label for="t6">T6</label>
                        <input type="checkbox" id="t7" name="days" value="Th·ª© B·∫£y"><label for="t7">T7</label>
                        <input type="checkbox" id="cn" name="days" value="Ch·ªß Nh·∫≠t"><label for="cn">CN</label>
                    </div>
                </div>

                <div class="input-group">
                    <label for="duration">Th·ªùi l∆∞·ª£ng trung b√¨nh m·ªói bu·ªïi (ph√∫t):</label>
                    <input type="number" id="duration" name="duration" min="15" max="180" value="60" required>
                </div>
            </div>

            <div class="plan-section target-section">
                <h2 class="section-title">üî• Weekly Target for Calorie Burn</h2>
                <div class="slider-group">
                    <label for="weekly_target">T·ªïng Calo m·ª•c ti√™u ƒë·ªët trong tu·∫ßn (kcal):</label>
                    <div class="slider-display">
                        <span id="targetValue">1500 kcal</span>
                        <input type="range" id="weekly_target" name="weekly_target" min="500" max="5000" value="1500"
                            step="100">
                    </div>
                </div>
            </div>

            <button type="submit" class="generate-btn" id="generateBtn">
                T·∫†O L·ªäCH T·∫¨P NGAY
            </button>

        </form>

        <div class="popup-overlay" id="planPopup">
            <div class="plan-box">
                <h2 class="schedule-title">üìÖ K·∫æ HO·∫†CH T·∫¨P LUY·ªÜN C√Å NH√ÇN</h2>
                <div id="planDetails">
                </div>

                <div class="plan-options">
                    <p>B·∫°n mu·ªën l√†m g√¨ ti·∫øp theo?</p>
                    <div class="option-buttons">
                        <button type="button" onclick="editPlan()">Ch·ªânh s·ª≠a m·ª•c ti√™u</button>
                        <button type="button" onclick="savePlan()">L∆∞u K·∫ø ho·∫°ch</button>
                        <button type="button" onclick="sharePlan()">Chia s·∫ª</button>
                    </div>
                </div>

                <button type="button" class="close-plan-btn" onclick="closePopup()">ƒê√≥ng & Ti·∫øp t·ª•c</button>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const weeklyTargetSlider = document.getElementById('weekly_target');
            const targetValueDisplay = document.getElementById('targetValue');
            const planForm = document.getElementById('planForm');
            const planPopup = document.getElementById('planPopup');
            const planDetails = document.getElementById('planDetails');

            // --- 1. C·∫≠p nh·∫≠t gi√° tr·ªã Slider ---
            weeklyTargetSlider.addEventListener('input', () => {
                targetValueDisplay.textContent = `${weeklyTargetSlider.value} kcal`;
            });

            // Kh·ªüi t·∫°o gi√° tr·ªã ban ƒë·∫ßu (ƒë·∫£m b·∫£o hi·ªÉn th·ªã ƒë√∫ng khi load)
            targetValueDisplay.textContent = `${weeklyTargetSlider.value} kcal`;


            // --- 2. X·ª≠ l√Ω Form Submission ---
            planForm.addEventListener('submit', (e) => {
                e.preventDefault();

                // Gi·∫£ ƒë·ªãnh c√°c th√¥ng tin c∆° b·∫£n (Tu·ªïi, C√¢n n·∫∑ng, Chi·ªÅu cao, Gi·ªõi t√≠nh)
                // ƒë√£ ƒë∆∞·ª£c l∆∞u tr·ªØ t·ª´ kh·∫£o s√°t ban ƒë·∫ßu c·ªßa ng∆∞·ªùi d√πng
                const assumedUserData = {
                    age: 30,
                    weight: 60, // kg
                    height: 170, // cm
                    gender: 'female',
                    bmi: (60 / (1.7 * 1.7)).toFixed(1)
                };

                // L·∫•y d·ªØ li·ªáu form
                const formData = new FormData(planForm);
                const data = { ...assumedUserData };

                // L·∫•y c√°c ng√†y ƒë√£ ch·ªçn
                const selectedDays = Array.from(document.querySelectorAll('input[name="days"]:checked')).map(cb => cb.value);
                data['days'] = selectedDays;

                for (let [key, value] of formData.entries()) {
                    if (key !== 'days') {
                        data[key] = value;
                    }
                }

                // Gi·∫£ l·∫≠p t·∫°o l·ªãch t·∫≠p
                const planHTML = generateMockPlan(data);

                planDetails.innerHTML = planHTML;
                planPopup.classList.add('show');
            });

            // --- 3. H√†m t·∫°o l·ªãch t·∫≠p gi·∫£ l·∫≠p ---
            function generateMockPlan(data) {
                const numDays = data.days.length;
                if (numDays === 0) {
                    return `<p style="color: var(--color-accent); font-family: 'DynaPuff', system-ui;">Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt ng√†y t·∫≠p luy·ªán!</p>`;
                }
                const dailyCalorie = Math.round(data.weekly_target / numDays);

                // L·∫•y icon v√† t√™n nh√≥m ho·∫°t ƒë·ªông ƒë√£ ch·ªçn
                const selectedActivityInput = document.querySelector(`input[name="activity"]:checked`);
                const activityName = selectedActivityInput.value;
                const activityIcon = selectedActivityInput.nextElementSibling.querySelector('.activity-icon').outerHTML;

                // Gi·∫£ l·∫≠p g·ª£i √Ω chi ti·∫øt d·ª±a tr√™n nh√≥m ho·∫°t ƒë·ªông
                let detailedActivity = "";
                switch (activityName) {
                    case "Ngo√†i tr·ªùi":
                        detailedActivity = "ƒêi b·ªô nhanh, ch·∫°y b·ªô, leo n√∫i nh·∫π ho·∫∑c ƒë·∫°p xe ngo√†i c√¥ng vi√™n.";
                        break;
                    case "Ngh·ªá thu·∫≠t":
                        detailedActivity = "Khi√™u v≈© (Zumba/Dance), Aerobic c∆∞·ªùng ƒë·ªô v·ª´a ho·∫∑c h·ªçc v√µ (Taekwondo/Karate).";
                        break;
                    case "Trong nh√†":
                        detailedActivity = "T·∫≠p Yoga, Pilates, c√°c b√†i t·∫≠p th·ªÉ d·ª•c t·∫°i ch·ªó ho·∫∑c b√†i t·∫≠p gi√£n c∆°.";
                        break;
                    case "Kh√°ng l·ª±c":
                        detailedActivity = "T·∫≠p t·∫°, squat, lunges, plank v√† c√°c b√†i t·∫≠p tƒÉng c∆∞·ªùng c∆° b·∫Øp.";
                        break;
                    default:
                        detailedActivity = "B√†i t·∫≠p k·∫øt h·ª£p ng·∫´u nhi√™n.";
                }

                let tableRows = '';

                data.days.forEach(day => {
                    const activityDescription = `${detailedActivity} k√©o d√†i ${data.duration} ph√∫t.`;
                    tableRows += `
                        <tr>
                            <td>${day}</td>
                            <td>${activityIcon} ${activityName}</td>
                            <td>${data.duration} ph√∫t</td>
                            <td>~${dailyCalorie} kcal</td>
                            <td>${activityDescription}</td>
                        </tr>
                    `;
                });

                // Th√™m h√†ng cho c√°c ng√†y ngh·ªâ
                const allDays = ["Th·ª© Hai", "Th·ª© Ba", "Th·ª© T∆∞", "Th·ª© NƒÉm", "Th·ª© S√°u", "Th·ª© B·∫£y", "Ch·ªß Nh·∫≠t"];
                allDays.filter(day => !data.days.includes(day)).forEach(day => {
                    tableRows += `
                        <tr>
                            <td>${day}</td>
                            <td>Ngh·ªâ ng∆°i üò¥</td>
                            <td>0 ph√∫t</td>
                            <td>0 kcal</td>
                            <td>Th∆∞ gi√£n v√† Ph·ª•c h·ªìi c∆°</td>
                        </tr>
                    `;
                });

                // Th√¥ng tin th√™m t·ª´ d·ªØ li·ªáu kh·∫£o s√°t
                const userInfoHTML = `
                    <p style="text-align: center; margin-bottom: 25px; font-style: italic; color: #555;">
                        (Th√¥ng tin ng∆∞·ªùi d√πng t·ª´ kh·∫£o s√°t ban ƒë·∫ßu: Tu·ªïi ${data.age}, C√¢n n·∫∑ng ${data.weight}kg, BMI ${data.bmi}).
                    </p>
                `;

                return `
                    ${userInfoHTML}
                    <div class="plan-table-container">
                        <table class="weekly-plan-table">
                            <thead>
                                <tr>
                                    <th>Ng√†y</th>
                                    <th>Nh√≥m ho·∫°t ƒë·ªông</th>
                                    <th>Th·ªùi l∆∞·ª£ng</th>
                                    <th>M·ª•c ti√™u Calo</th>
                                    <th>G·ª£i √Ω chi ti·∫øt</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${tableRows}
                            </tbody>
                        </table>
                    </div>
                    <p style="font-family: 'DynaPuff', system-ui; font-size: 1.1rem; color: var(--color-accent);">
                        üéâ T·ªïng m·ª•c ti√™u Calo tu·∫ßn n√†y: ${data.weekly_target} kcal, chia ƒë·ªÅu cho ${numDays} ng√†y t·∫≠p.
                    </p>
                `;
            }

            // --- 4. X·ª≠ l√Ω Popup actions ---
            window.closePopup = () => {
                planPopup.classList.remove('show');
            };

            window.editPlan = () => {
                window.closePopup();
                // Logic cu·ªôn l√™n ƒë·ªÉ ch·ªânh s·ª≠a form
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            window.savePlan = () => {
                alert("ƒê√£ l∆∞u k·∫ø ho·∫°ch v√†o b·ªô s∆∞u t·∫≠p c√° nh√¢n c·ªßa b·∫°n!");
            };

            window.sharePlan = () => {
                alert("K·∫ø ho·∫°ch ƒë√£ s·∫µn s√†ng ƒë·ªÉ chia s·∫ª (Ch·ª©c nƒÉng n√†y ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn).");
            };
        });
    </script>

    <script>
        const aboutBtn = document.getElementById("aboutBtn");
        const aboutPopup = document.getElementById("aboutPopup");
        const popupBox = document.querySelector(".popup-box");

        // m·ªü popup
        aboutBtn.addEventListener("click", () => {
            aboutPopup.style.display = "flex";
        });

        // click ngo√†i popup ƒë·ªÉ t·∫Øt
        aboutPopup.addEventListener("click", (e) => {
            if (!popupBox.contains(e.target)) {
                aboutPopup.style.display = "none";
            }
        });
    </script>

</body>

</html>